<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Updating an Inline Policy for a Resource</title>
</head><body><b>Description: </b>An attacker with the <u>iam:PutUserPolicy</u>, <u>iam:PutGroupPolicy</u>, or <u>iam:PutRolePolicy</u>&nbsp;permissions can escalate privileges by updating an existing inline policy for a user, group, or role that they have access to, adding the permissions of the updated policy to the attacker.<br/>
&nbsp;<br/>
Some example commands to exploit this method might look like these:<br/>
<i>aws iam put-user-policy –user-name my_username –policy-name my_inline_policy –policy-document file://path/to/administrator/policy.json</i><br/>
&nbsp;<br/>
<i>aws iam put-group-policy –group-name group_i_am_in –policy-name group_inline_policy –policy-document file://path/to/administrator/policy.json</i><br/>
&nbsp;<br/>
<i>aws iam put-role-policy –role-name role_i_can_assume –policy-name role_inline_policy –policy-document file://path/to/administrator/policy.json</i><br/>
&nbsp;<br/>
Where the user name is the current user, the group is a group the current user is in, or the role is a role that the current user can temporarily assume with <u>sts:AssumeRole</u>.<br/>
&nbsp;<br/>
<b>Potential Impact: </b>Due to the ability to specify an arbitrary policy document with this method, the attacker could specify a policy that gives permission to perform any action on any resource, ultimately escalating to full administrator privileges in the AWS environment.<br/>
&nbsp; &nbsp;</body></html>