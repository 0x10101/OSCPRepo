<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Attaching a Policy to a Resource</title>
</head><body><b>Description: </b>An attacker with the <u>iam:AttachUserPolicy</u>, <u>iam:AttachGroupPolicy</u>, or <u>iam:AttachRolePolicy</u>&nbsp;permissions can escalate privileges by attaching a policy to a user, group, or role that they have access to, adding the permissions of that policy to the attacker.<br/>
&nbsp;<br/>
Some example commands to exploit this method might look like these:<br/>
<i>aws iam attach-user-policy –user-name my_username –policy-arn arn:aws:iam::aws:policy/AdministratorAccess</i><br/>
&nbsp;<br/>
<i>aws iam attach-group-policy –group-name group_i_am_in –policy-arn arn:aws:iam::aws:policy/AdministratorAccess</i><br/>
&nbsp;<br/>
<i>aws iam attach-role-policy –role-name role_i_can_assume –policy-arn arn:aws:iam::aws:policy/AdministratorAccess</i><br/>
&nbsp;<br/>
Where the user name is the current user, the group is a group the current user is in, or the role is a role that the current user can temporarily assume with <u>sts:AssumeRole</u>.<br/>
&nbsp;<br/>
<b>Potential Impact: </b>An attacker would be able to use this method to attach the AdministratorAccess AWS managed policy to a user, group, or role, giving them full administrator access to the AWS environment.<br/>
&nbsp; &nbsp;</body></html>