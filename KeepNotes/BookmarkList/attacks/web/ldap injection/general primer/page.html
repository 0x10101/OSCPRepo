<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>LDAP Injection<br/>
LDAP Injection is an attack technique used to exploit web sites that construct LDAP statements from user-supplied input.<br/>
<br/>
Lightweight Directory Access Protocol (LDAP) is an open-standard protocol for both querying and manipulating X.500 directory services. The LDAP protocol runs over Internet transport protocols, such as TCP. Web applications may use user-supplied input to create custom LDAP statements for dynamic web page requests.<br/>
<br/>
When a web application fails to properly sanitize user-supplied input, it is possible for an attacker to alter the construction of an LDAP statement. When an attacker is able to modify an LDAP statement, the process will run with the same permissions as the component that executed the command. (e.g. Database server, Web application server, Web server, etc.). This can cause serious security problems where the permissions grant the rights to query, modify or remove anything inside the LDAP tree. The same advanced exploitation techniques available in SQL Injection can also be similarly applied in LDAP Injection.<br/>
<br/>
Mitigation <br/>
The escape sequence for properly using user supplied input into LDAP differs depending on if the user input is used to create the DN (Distinguished Name) or used as part of the search filter. The listings below shows the character that needs to be escape and the appropriate escape method for each case.<br/>
&nbsp;<br/>
<b>Used in DN - Requires \ escape</b><br/>
&nbsp;<ul><li>&amp;</li>
<li>!</li>
<li>|</li>
<li>=</li>
<li>&lt;</li>
<li>&gt;</li>
<li>,</li>
<li>+</li>
<li>-</li>
<li>"</li>
<li>'</li>
<li>;</li>
</ul>
<br/>
<b>Used in Filter- Requires {\ASCII} escape</b><br/>
&nbsp;<ul><li>(           {\28}</li>
<li>)           {\29}</li>
<li>\           {\5c}</li>
<li>*           {\2a}</li>
<li>/           {\2f}</li>
<li>NUL      {\0}</li>
</ul>
</body></html>