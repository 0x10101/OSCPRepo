<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CSP Frame-Ancestors</title>
</head><body><b>Defending with Content Security Policy (CSP) frame-ancestors directive</b><br/>
The frame-ancestors directive can be used in a Content-Security-Policy HTTP response header to indicate whether or not a browser should be allowed to render a page in a &lt;frame&gt; or &lt;iframe&gt;. Sites can use this to avoid Clickjacking attacks by ensuring that their content is not embedded into other sites.<br/>
<br/>
frame-ancestors allows a site to authorize multiple domains using the normal Content Security Policy semantics.<br/>
<br/>
<b>Content-Security-Policy: frame-ancestors Examples</b><br/>
Common uses of CSP frame-ancestors:<br/>
<ul><li style="list-style-type: none">Content-Security-Policy: frame-ancestors 'none';</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">This prevents any domain from framing the content. This setting is recommended unless a specific need has been identified for framing.</li>
</ul>
</li>
<li style="list-style-type: none">Content-Security-Policy: frame-ancestors 'self';</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">This only allows the current site to frame the content.</li>
</ul>
</li>
<li style="list-style-type: none">Content-Security-Policy: frame-ancestors 'self' '\*.somesite.com' 'https://myfriend.site.com';</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">This allows the current site, as well as any page on somesite.com (using any protocol), and only the page myfriend.site.com, using HTTPS only on the default port (443).</li>
</ul>
</li>
<li style="list-style-type: none"></li>
</ul>
Note that the single quotes are required.<br/>
<br/>
See the following documentation for further details and more complex examples:<br/>
<br/>
<a href="https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors">https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors</a><br/>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors</a><br/>
<br/>
<b>Limitations</b><br/>
<b>Browser support</b>: CSP frame-ancestors is not supported by all the major browsers yet.<br/>
<b>X-Frame-Options takes priority</b>: S<a href="https://w3c.github.io/webappsec/specs/content-security-policy/#frame-ancestors-and-frame-options">ection "Relation to X-Frame-Options" of the CSP Spec</a>&nbsp;says: "If a resource is delivered with an policy that includes a directive named frame-ancestors and whose disposition is "enforce", then the X-Frame-Options header MUST be ignored", but Chrome 40 &amp; Firefox 35 ignore the frame-ancestors directive and follow the X-Frame-Options header instead.</body></html>