<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Exchange Backdoor</title>
</head><body>Exchange Server introduces several schema changes, new <i>nested</i>&nbsp;security groups, and many control relationships to AD (perfect place to blend in)<br/>
Pre-Exchange 2007 SP1, this included WriteDACL privilege against the domain object itself, which was distributed down to ALL securable objects!<br/>
<br/>
Backdoor:<ul><li>Identify a non-protected security group with local admin rights on one or more Exchange servers</li>
<li>Grant "Authenticated Users" full control over this security group</li>
<li>Change the owner of the group to an Exchange server</li>
<li>Deny "Read Permissions" on this group to the "Everyone" principal</li>
</ul>
<br/>
Result:<ul><li>Regain access to the AD domain as any user</li>
<li>Add your current user to the back-doored security group</li>
<li>Use local admin rights on Exchange to execute commands as the SYSTEM user on that computer</li>
<li>Exchange Trusted Subsystem often has full control of the domain, so this may include DCSync!</li>
</ul>
<br/>
<br/>
<br/>
</body></html>