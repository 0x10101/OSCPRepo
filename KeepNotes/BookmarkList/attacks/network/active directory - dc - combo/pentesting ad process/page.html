<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Pentesting AD Process</title>
</head><body>DNS Spoofing / Relaying<br/>
&nbsp;&#09;IPv6 (preferred over IPv4)<br/>
&nbsp;&#09;LLMNR/NBT-NS Spoofing / Relaying<br/>
&nbsp;&#09;ADIDNS Spoofing / Abusing<ul><li style="list-style-type: none">MAQ Adding / Relaying</li>
</ul>
WPAD Spoofing / Relaying<br/>
Kerberos Spoofing / Relaying<br/>
&nbsp;&#09;SPNs / Kerberoasting<ul><li style="list-style-type: none">ASEPRoasting </li>
</ul>
&nbsp;&#09;DNS + Relaying<br/>
&nbsp;&#09;Kerberos abuse<br/>
&nbsp;&#09;&#09;Unconstrained Delegation<br/>
&nbsp;&#09;&#09;Constrained Delegation<ul><li style="list-style-type: none"><ul><li style="list-style-type: none">Resource-Based Constrained Delegation</li>
</ul>
</li>
</ul>
SMB Testing [CME] (requires account and password/hash, or list to spray/brute)<br/>
Exchange Abuse<br/>
SYSVOL and Clear Text passwords in shares<br/>
LDAP Abuse<br/>
<br/>
Popular Windows Exploits against unpatched systems (EBlue, SMB, Kerberos, etc)<br/>
<br/>
Accounts and Lateral Movement<br/>
PowerView<br/>
Bloodhound<br/>
<br/>
Security Descriptors<br/>
&nbsp;&#09;Need to audit every remotely accessible service on every host + AD descriptors<br/>
&nbsp;&#09;&#09;Includes "unrolling" groups, which may not be (currently) realistically possible to model in large environments<br/>
&nbsp;&#09;BloodHound doesn't (currently) take host-based security descriptors into account<br/>
&nbsp;&#09;There ARE existing misconfigurations in the security descriptors in some host-based services!<br/>
&nbsp;&#09;&#09;Host-based security descriptor modifications can be chained with AD misconfigurations/modifications</body></html>