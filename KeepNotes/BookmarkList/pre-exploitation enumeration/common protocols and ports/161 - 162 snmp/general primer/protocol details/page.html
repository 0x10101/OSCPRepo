<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Protocol Details</title>
</head><body>Protocol details<br/>
SNMP operates in the <a href="https://en.wikipedia.org/wiki/Application_layer">application layer</a>&nbsp;of the <a href="https://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite</a>. All SNMP messages are transported via <a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">User Datagram Protocol</a>&nbsp;(UDP). The SNMP agent receives requests on <a href="https://en.wikipedia.org/wiki/UDP_port">UDP port</a>&nbsp;161. The manager may send requests from any available source port to port 161 in the agent. The agent response is sent back to the source port on the manager. The manager receives notifications (<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#Trap"><i>Traps</i></a>&nbsp;and <a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#InformRequest"><i>InformRequests</i></a>) on port 162. The agent may generate notifications from any available port. When used with <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security</a>&nbsp;or <a href="https://en.wikipedia.org/wiki/Datagram_Transport_Layer_Security">Datagram Transport Layer Security</a>, requests are received on port 10161 and notifications are sent to port 10162.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-3">[3]</a>&nbsp;<br/>
<br/>
SNMPv1 specifies five core <a href="https://en.wikipedia.org/wiki/Protocol_data_unit">protocol data units</a>&nbsp;(PDUs). Two other PDUs, <i>GetBulkRequest</i>&nbsp;and <i>InformRequest</i>&nbsp;were added in SNMPv2 and the <i>Report</i>&nbsp;PDU was added in SNMPv3. All SNMP PDUs are constructed as follows: <br/>
<br/>
&nbsp; &nbsp;IP header &nbsp;UDP header &nbsp;version &nbsp;community &nbsp;PDU-type &nbsp;request-id &nbsp;error-status &nbsp;error-index &nbsp;variable bindings &nbsp;<br/>
<br/>
The seven SNMP PDU types as identified by the <i>PDU-type</i>&nbsp;field are as follows: <br/>
&nbsp;<br/>
GetRequest <br/>
A manager-to-agent request to retrieve the value of a variable or list of variables. Desired variables are specified in variable bindings (the value field is not used). Retrieval of the specified variable values is to be done as an <a href="https://en.wikipedia.org/wiki/Atomic_operation">atomic operation</a>&nbsp;by the agent. A <i>Response</i>&nbsp;with current values is returned. <br/>
<br/>
SetRequest <br/>
A manager-to-agent request to change the value of a variable or list of variables. Variable bindings are specified in the body of the request. Changes to all specified variables are to be made as an atomic operation by the agent. A <i>Response</i>&nbsp;with (current) new values for the variables is returned. <br/>
<br/>
GetNextRequest <br/>
A manager-to-agent request to discover available variables and their values. Returns a <i>Response</i>&nbsp;with variable binding for the <a href="https://en.wikipedia.org/wiki/Lexicographical_order">lexicographically next</a>&nbsp;variable in the MIB. The entire MIB of an agent can be walked by iterative application of <i>GetNextRequest</i>&nbsp;starting at OID 0. Rows of a table can be read by specifying column OIDs in the variable bindings of the request. <br/>
<br/>
GetBulkRequest <br/>
A manager-to-agent request for multiple iterations of <i>GetNextRequest</i>. An optimized version of <i>GetNextRequest</i>. Returns a <i>Response</i>&nbsp;with multiple variable bindings walked from the variable binding or bindings in the request. PDU specific <i>non-repeaters</i>&nbsp;and <i>max-repetitions</i>&nbsp;fields are used to control response behavior. <i>GetBulkRequest</i>&nbsp;was introduced in SNMPv2. <br/>
<br/>
Response <br/>
Returns variable bindings and acknowledgement from agent to manager for <i>GetRequest</i>, <i>SetRequest</i>, <i>GetNextRequest</i>, <i>GetBulkRequest</i>&nbsp;and <i>InformRequest</i>. Error reporting is provided by <i>error-status</i>&nbsp;and <i>error-index</i>&nbsp;fields. Although it was used as a response to both gets and sets, this PDU was called <i>GetResponse</i>&nbsp;in SNMPv1. <br/>
<br/>
Trap <br/>
Asynchronous notification from agent to manager. While in other SNMP communication, the manager actively requests information from the agent, these are PDUs that are sent from the agent to the manager without being explicitly requested. SNMP <a href="https://en.wikipedia.org/wiki/Trap_(computing)">traps</a>&nbsp;enable an agent to notify the management station of significant events by way of an unsolicited SNMP message. Trap PDUs include current <i>sysUpTime</i>&nbsp;value, an OID identifying the type of trap and optional variable bindings. Destination addressing for traps is determined in an application-specific manner typically through trap configuration variables in the MIB. The format of the trap message was changed in SNMPv2 and the PDU was renamed <i>SNMPv2-Trap</i>. <br/>
<br/>
InformRequest <br/>
Acknowledged asynchronous notification. This PDU was introduced in SNMPv2 and was originally defined as <i>manager to manager</i>&nbsp;communication.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-4">[4]</a>&nbsp;Later implementations have loosened the original definition to allow <i>agent to manager</i>&nbsp;communications.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-5">[5]</a><a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-cisco_a-6">[6]</a><a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-7">[7]</a>&nbsp;Manager-to-manager notifications were already possible in SNMPv1 using a <i>Trap</i>, but as SNMP commonly runs over UDP where delivery is not assured and dropped packets are not reported, delivery of a <i>Trap</i>&nbsp;was not guaranteed. <i>InformRequest</i>&nbsp;fixes this as an acknowledgement is returned on receipt.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-cisco_a-6">[6]</a>&nbsp;<br/>
<br/>
<a href="https://en.wikipedia.org/wiki/Request_for_Comments_(identifier)">RFC</a>Â <a href="https://tools.ietf.org/html/rfc1157">1157</a>&nbsp;specifies that an SNMP implementation must accept a message of at least 484 bytes in length. In practice SNMP implementations accept longer messages.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-Tipton-8">[8]</a>:1870 If implemented correctly, an SNMP message is discarded if the decoding of the message fails and thus malformed SNMP requests are ignored. A successfully decoded SNMP request is then authenticated using the community string. If the authentication fails, a trap is generated indicating an authentication failure and the message is dropped.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-Tipton-8">[8]</a>:1871 <br/>
<br/>
SNMPv1 and SNMPv2 use <i>communities</i>&nbsp;to establish trust between managers and agents. Most agents support three community names, one each for read-only, read-write and trap. These three community strings control different types of activities. The read-only community applies to <i>get</i>&nbsp;requests. The read-write community string applies to <i>set</i>&nbsp;requests. The trap community string applies to receipt of <i>traps</i>. SNMPv3 also uses community strings, but allows for secure authentication and communication between SNMP manager and agent.<a href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#cite_note-9">[9]</a>&nbsp;<br/>
&nbsp; </body></html>