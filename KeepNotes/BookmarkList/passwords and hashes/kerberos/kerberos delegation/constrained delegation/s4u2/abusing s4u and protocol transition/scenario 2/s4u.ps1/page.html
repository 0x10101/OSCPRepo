<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>S4U.ps1</title>
</head><body># translated from the C# example at https://msdn.microsoft.com/en-us/library/ff649317.aspx<br/>
&nbsp;<br/>
# load the necessary assembly<br/>
$Null = [Reflection.Assembly]::LoadWithPartialName('System.IdentityModel')<br/>
&nbsp;<br/>
# execute S4U2Self w/ WindowsIdentity to request a forwardable TGS for the specified user<br/>
$Ident = New-Object System.Security.Principal.WindowsIdentity @('Administrator@TESTLAB.LOCAL')<br/>
&nbsp;<br/>
# actually impersonate the next context<br/>
$Context = $Ident.Impersonate()<br/>
&nbsp;<br/>
# implicitly invoke S4U2Proxy with the specified action<br/>
ls \\PRIMARY.TESTLAB.LOCAL\C$<br/>
&nbsp;<br/>
# undo the impersonation context<br/>
$Context.Undo()</body></html>