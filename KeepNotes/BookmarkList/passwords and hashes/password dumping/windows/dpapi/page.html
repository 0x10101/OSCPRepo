<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>DPAPI</title>
</head><body><br/>
There has been some work done previously regarding attacking DPAPI:<br/>
&nbsp;<ul><li><a href="https://www.elie.net/publication/reversing-dpapi-and-stealing-windows-secrets-offline">Reversing DPAPI and Stealing Windows Secrets Offline</a></li>
<li><a href="http://www.passcape.com/index.php?section=docsys&cmd=details&id=28">DPAPI Secrets. Security analysis and data recovery in DPAPI</a></li>
</ul>
<br/>
Benjamin Delpy has an Excel spreadsheet on OneDrive which lists Windows locations that may have stored credentials – <a href="https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!3104&app=Excel">view the spreadsheet online</a>.<br/>
<br/>
https://www.harmj0y.net/blog/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/ <br/>
<br/>
DPAPI Crash Course <br/>
I’m also not going to cover a ton of DPAPI background, as that’s been done much better by others:<br/>
&nbsp;<ul><li>&nbsp;Benjamin’s wiki examples (<a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-dpapi">here</a>, <a href="https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials">here</a>&nbsp;and <a href="https://github.com/gentilkiwi/mimikatz/wiki/howto-~-decrypt-EFS-files">here</a>) as well as various <a href="https://twitter.com/search?l=&q=dpapi%20from%3Agentilkiwi&src=typd">DPAPI-related tweets</a></li>
<li>Bartosz Inglot’s “<a href="https://github.com/comaeio/OPCDE/blob/master/2017/The%20Blackbox%20of%20DPAPI%20the%20gift%20that%20keeps%20on%20giving%20-%20Bartosz%20Inglot/The%20Blackbox%20of%20DPAPI%20-%20Bart%20Inglot.pdf">The Blackbox of DPAPI</a>” talk at OPCDE 2017</li>
<li>“<a href="https://www.slideshare.net/paulajanuszkiewicz/black-hat-europe-2017-dpapi-and-dpaping-decryption-toolkit">DPAPI and DPAPI-NG</a>” at Black Hat Europe 2017 by Paula J</li>
<li>“<a href="https://www.synacktiv.com/ressources/univershell_2017_dpapi.pdf">DPAPI exploitation during pentest and password cracking</a>” by Jean-Christophe Delaunay (<a href="http://twitter.com/Fist0urs">@Fist0urs</a>)</li>
<li>“<a href="https://digital-forensics.sans.org/summit-archives/dfirprague14/Give_Me_the_Password_and_Ill_Rule_the_World_Francesco_Picasso.pdf">give me the password and I’ll rule the world</a>“ by Francesco Picasso (<a href="https://twitter.com/dfirfpi">@dfirfpi</a>), follow up <a href="http://blog.digital-forensics.it/2015/01/happy-dpapi.html">article here</a>, as well as his “<a href="https://www.slideshare.net/realitynet/revaulting-decryption-and-opportunities">ReVaulting</a>” talk</li>
<li><a href="https://twitter.com/ItaiGrady/">Itai Grady</a>‘s “<a href="https://www.slideshare.net/ItaiGrady/protecting-browsers-secrets-in-adomainenvironment">Protecting browsers’ secrets in a domain environment</a>” talk from <a href="https://twitter.com/BsidesTLV">@BsidesTLV</a></li>
<li>“<a href="https://elie.net/static/files/reversing-dpapi-and-stealing-windows-secrets-offline/reversing-dpapi-and-stealing-windows-secrets-offline-slides.pdf">Decrypting DPAPI data</a>” by Jean-Michel Picod and Elie Bursztein</li>
<li><a href="https://twitter.com/_rastamouse">@_rastamouse</a>’s <a href="https://rastamouse.me/2017/08/jumping-network-segregation-with-rdp/">great post on</a>&nbsp;jumping network segmentation, which includes a section on using Mimikatz to decrypt DPAPI-encrypted RDP credential blobs</li>
</ul>
&nbsp;</body></html>