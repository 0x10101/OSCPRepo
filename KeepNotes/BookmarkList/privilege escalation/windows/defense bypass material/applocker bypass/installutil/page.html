<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>InstallUtil</title>
</head><body>https://decoder.cloud/2017/11/17/we-dont-need-powershell-exe-part-3/ - Great walkthrough<br/>
<a href="https://attack.mitre.org/techniques/T1118/">https://attack.mitre.org/techniques/T1118/</a>&nbsp; <br/>
<span style="font-size: 10pt"><br/>
<br/>
<div style="text-align: left"><span style="font-family: Roboto-Regular">InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. <a href="https://msdn.microsoft.com/en-us/library/50614e95.aspx">[1]</a> InstallUtil is located in the .NET directories on a Windows system: <br/>
C:\Windows\Microsoft.NET\Framework\v\InstallUtil.exe <br/>
and <br/>
C:\Windows\Microsoft.NET\Framework64\v\InstallUtil.exe.<br/>
</span></div><br/>
InstallUtil.exe is digitally signed by Microsoft<br/>
<br/>
<div style="text-align: left"><span style="font-family: Roboto-Regular">Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil may also be used to bypass process whitelisting through use of attributes within the binary that execute the class decorated with the attribute [System.ComponentModel.RunInstaller(true)]. [2]<br/>
</span></div>&nbsp; <br/>
<br/>
</span><span style="font-size: 10pt">InstallUtil located in </span><br/>
C:\Windows\Microsoft.NET\Framework\v4.0.30319 <br/>
C:\Windows\Microsoft.NET\Framework64\v4.0.3031964<br/>
(may be in other Framework folders as well)<br/>
<br/>
.\InstallUtil.exe /logfile= /LogToConsole=false /U C:\users\user\folder\exe/ini/txt/etc<br/>
<br/>
The module needs to contain an assembly manifest<br/>
<br/>
<ul><li>Windows binary: True</li>
<li>Bypasses Default AppLocker Rules: True</li>
<li>Mitre: <a href="https://attack.mitre.org/wiki/Technique/T1118">T1118</a></li>
<li>Links:</li>
<li style="list-style-type: none"><ul><li><a href="https://pentestlab.blog/2017/05/08/applocker-bypass-installutil/">https://pentestlab.blog/2017/05/08/applocker-bypass-installutil/</a></li>
<li><a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_12">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_12</a></li>
<li><a href="https://www.blackhillsinfosec.com/powershell-without-powershell-how-to-bypass-application-whitelisting-environment-restrictions-av/">https://www.blackhillsinfosec.com/powershell-without-powershell-how-to-bypass-application-whitelisting-environment-restrictions-av/</a></li>
<li><a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a></li>
</ul>
</li>
</ul>
<ul><ul><a href="https://www.rapid7.com/db/modules/exploit/windows/local/applocker_bypass">https://www.rapid7.com/db/modules/exploit/windows/local/applocker_bypass</a></ul>
</ul>
<ul>File path:</ul>
<ul><li style="list-style-type: none"><ul><li>C:\Windows\Microsoft.NET\Framework\v2.0.50727\InstallUtil.exe</li>
<li>C:\Windows\Microsoft.NET\Framework64\v2.0.50727\InstallUtil.exe</li>
<li>C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil.exe</li>
</ul>
</li>
</ul>
<ul><ul>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe</ul>
</ul>
<ul>Acknowledgement:</ul>
<ul><li style="list-style-type: none"><ul><li>Name: Casey Smith</li>
<li style="list-style-type: none"><ul><li>Twitter: <a href="https://twitter.com/@Subtee">@Subtee</a></li>
<li>Blog: <a href="https://subt0x11.blogspot.com/">https://subt0x11.blogspot.com/</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
OS: Windows 10 1703<br/>
</body></html>