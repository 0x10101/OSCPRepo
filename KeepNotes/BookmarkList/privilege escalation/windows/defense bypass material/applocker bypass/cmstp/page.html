<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CMSTP</title>
</head><body><a href="https://attack.mitre.org/techniques/T1191/">https://attack.mitre.org/techniques/T1191/</a>&nbsp; <br/>
<br/>
<span style="font-size: 10pt"><br/>
<div style="text-align: left"><span style="font-family: Roboto-Regular">The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles. <a href="https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc786431(v=ws.10)">[1]</a> CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections.<br/>
</span></div><br/>
<div style="text-align: left"><span style="font-family: Roboto-Regular">Adversaries may supply CMSTP.exe with INF files infected with malicious commands. <a href="https://twitter.com/ItsReallyNick/status/958789644165894146">[2]</a> Similar to <a href="https://attack.mitre.org/techniques/T1117">Regsvr32</a> / "Squiblydoo", CMSTP.exe may be abused to load and execute DLLs <a href="https://msitpros.com/?p=3960">[3]</a> and/or COM scriptlets (SCT) from remote servers. <a href="https://twitter.com/NickTyrer/status/958450014111633408">[4]</a> <a href="https://github.com/api0cradle/UltimateAppLockerByPassList">[5]</a> <a href="http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/">[6]</a> This execution may also bypass AppLocker and other whitelisting defenses since CMSTP.exe is a legitimate, signed Microsoft application.<br/>
</span></div><br/>
<div style="text-align: left"><span style="font-family: Roboto-Regular">CMSTP.exe can also be abused to <a href="https://attack.mitre.org/techniques/T1088">Bypass User Account Control</a> and execute arbitrary commands from a malicious INF through an auto-elevated COM interface. <a href="https://msitpros.com/?p=3960">[3]</a> <a href="https://github.com/api0cradle/UltimateAppLockerByPassList">[5]</a> <a href="http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/">[6]</a><br/>
</span></div>&nbsp; </span></body></html>