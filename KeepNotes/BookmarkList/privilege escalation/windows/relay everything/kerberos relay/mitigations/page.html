<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Mitigations</title>
</head><body><b>Mitigations and detection </b><br/>
The most straightforward mitigation is to avoid using unconstrained delegation wherever possible. Constrained delegation is much safer and while it can be abused as well, constrained delegation only allows for authentication to services which you explicitly specify, making it possible to make a risk analysis for individual services. Unconstrained delegation makes this depend on whichever user connects to the service, which then has their credentials exposed. If running accounts with unconstrained delegation rights cannot be avoided, the following mitigations can be applied:<br/>
&nbsp;<br/>
&nbsp;<ul><li>Make sure to guard the systems that have these privileges as sensitive assets from which domain compromise is likely possible.</li>
<li>Protect sensitive accounts by enabling the option “Account is sensitive and cannot be delegated” option.</li>
<li>Place administrative accounts in the “Protected Users” group, which will prevent their credentials from being delegated.</li>
<li>Make sure that administrative accounts perform their actions from up-to-date workstations with Credential Guard enabled, which will prevent credential delegation.</li>
</ul>
<br/>
Regarding detection, Roberto Rodriguez from Specterops <a href="https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1">wrote an article</a>&nbsp;a while back about the exact events involved with unconstrained delegation which allow detection of unconstrained delegation abuse.<br/>
&nbsp; </body></html>