<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Cadmus MAC Address</title>
</head><body>//http://waleedassar.blogspot.com (@waleedassar)<br/>
//VirtualBox Adapters (Host and Guests) always have their MAC addresses in the form of 08-00-27-??-??-??. This range was originally assigned to Cadmus Computer Systems.<br/>
//This might show false positive results, but has not been witnessed so far.<br/>
#include "stdafx.h"<br/>
#include "winsock2.h"<br/>
#include "iphlpapi.h"<br/>
#include "ws2tcpip.h"<br/>
#include "windows.h"<br/>
#include "stdio.h"<br/>
<br/>
<br/>
int main(int argc, char* argv[])<br/>
{<br/>
&#09;WSADATA WSD;<br/>
&#09;if(!WSAStartup(MAKEWORD(2,2),&amp;WSD))<br/>
&#09;{<br/>
&#09;&#09;unsigned long tot_size=0;<br/>
&#09;&#09;int ret=GetAdaptersAddresses(AF_UNSPEC,GAA_FLAG_INCLUDE_PREFIX,0,0,&amp;tot_size);<br/>
&#09;&#09;if(ret==ERROR_BUFFER_OVERFLOW)<br/>
&#09;&#09;{<br/>
&#09;&#09;&#09;IP_ADAPTER_ADDRESSES* px=(IP_ADAPTER_ADDRESSES*)LocalAlloc(LMEM_ZEROINIT,tot_size);<br/>
&#09;&#09;&#09;if(px)<br/>
&#09;&#09;&#09;{<br/>
&#09;&#09;&#09;&#09;ret=GetAdaptersAddresses(AF_UNSPEC,GAA_FLAG_INCLUDE_PREFIX,0,px,&amp;tot_size);<br/>
&#09;&#09;&#09;&#09;IP_ADAPTER_ADDRESSES* pxx=px;<br/>
&#09;&#09;&#09;&#09;//Traverse a singly-linked list<br/>
&#09;&#09;&#09;&#09;for(pxx;pxx;pxx=pxx-&gt;Next)<br/>
&#09;&#09;&#09;&#09;{<br/>
&#09;&#09;&#09;&#09;&#09;if(pxx-&gt;PhysicalAddressLength==0x6)<br/>
&#09;&#09;&#09;&#09;&#09;{<br/>
&#09;&#09;&#09;&#09;&#09;&#09;if(wcsicmp(pxx-&gt;FriendlyName,L"VirtualBox Host-Only Network")) &nbsp;//We don't want to detect the HOST OS<br/>
&#09;&#09;&#09;&#09;&#09;&#09;{<br/>
&#09;&#09;&#09;&#09;&#09;&#09; &nbsp; &nbsp;char xx[0x6]={0};<br/>
&#09;&#09;&#09;&#09;&#09;&#09; &nbsp; &nbsp;memcpy(xx,pxx-&gt;PhysicalAddress,0x6);<br/>
&#09;&#09;&#09;&#09;&#09;&#09;&#09;if(xx[0]==0x08&amp;&amp; xx[1]==0x00 &amp;&amp; xx[2]==0x27) //Cadmus Computer Systems Mac address<br/>
&#09;&#09;&#09;&#09;&#09;&#09;&#09;{<br/>
&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;MessageBox(0,L"VirtualBox detected",L"waliedassar",0);<br/>
&#09;&#09;&#09;&#09;&#09;&#09;&#09;}<br/>
&#09;&#09;&#09;&#09;&#09;&#09;}<br/>
&#09;&#09;&#09;&#09;&#09;}<br/>
&#09;&#09;&#09;&#09;}<br/>
&#09;&#09;&#09;&#09;LocalFree(px);<br/>
&#09;&#09;&#09;}<br/>
&#09;&#09;}<br/>
&#09;&#09;WSACleanup();<br/>
&#09;}<br/>
&#09;ExitProcess(0);<br/>
&#09;return 0;<br/>
}</body></html>