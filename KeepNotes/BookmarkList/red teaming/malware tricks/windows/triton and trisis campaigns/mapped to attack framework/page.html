<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Mapped to ATTACK Framework</title>
</head><body><br/>
The following table provides insights into notable methodologies surrounding the use of custom tools and tips for identifying evidence of this and related activity. Adversary methodologies are also expressed in terms of the MITRE ATT&amp;CK framework (see <a href="https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/TRITON_Appendix_C.pdf">Appendix C</a>&nbsp;for MITRE ATT&amp;CK JSON raw data).<br/>
&nbsp; <br/>
<b><u>Adversary Methodology</u></b>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;<u><b>Discovery Tips</b></u><br/>
Persistence by Scheduled Tasks by XML trigger<br/>
<a href="https://attack.mitre.org/techniques/T1053/">ATT&amp;CK: T1053</a>&nbsp; &nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for new and anomalous <a href="https://docs.microsoft.com/en-us/windows/desktop/taskschd/daily-trigger-example--xml-">Scheduled Tasks XML triggers</a>&nbsp;referencing unsigned .exe files.<br/>
<br/>
Persistence by IFEO injection <br/>
<a href="https://attack.mitre.org/techniques/T1183/">ATT&amp;CK: T1183</a>&nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for modifications and new entries referencing .exe files under registry key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options.<br/>
&nbsp; <br/>
Command and control (C2) established using hard-coded DNS servers&#09;Look for PEs executions with run DNS lookups to 8.8.8.8:53. This may be applicable to sandbox and other malware processing technologies.<br/>
&nbsp; <br/>
C2 using favored C2ports<br/>
<a href="https://attack.mitre.org/techniques/T1043/">ATT&amp;CK: T1043</a><br/>
<a href="https://attack.mitre.org/techniques/T1065/">ATT&amp;CK: T1065</a>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for outbound connections with port-protocol mismatches on common and uncommon ports such as 443, 4444, 8531, and 50501.<br/>
&nbsp; <br/>
C2 using favored Virtual Private Server (VPS) infrastructure<br/>
<a href="https://attack.mitre.org/techniques/T1329/">ATT&amp;CK: T1329</a>&nbsp; &nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for inbound and outbound connections from and to non-standard IP ranges, especially from international VPS providers like OVH and UK-2 Limited (uk2.net).<br/>
&nbsp; <br/>
C2 domains with hyphen&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for newly observed 2LD and 3LD domains that contain hyphens.<br/>
&nbsp; <br/>
C&amp;C using dynamic DNS domains from afraid.org<br/>
<a href="https://attack.mitre.org/techniques/T1311/">ATT&amp;CK: T1311</a>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for newly observed dynamic DNS domains owned or registered with afraid.org.<br/>
&nbsp; <br/>
C2 domains registered with vfemail.net email addresses&#09;&#09;&#09;Look for newly observed domains or DNS resolutions to domains with registrant email information containing vfemail.net<br/>
&nbsp; <br/>
Tunneled RDP using PLINK<br/>
<a href="https://attack.mitre.org/techniques/T1076/">ATT&amp;CK: T1076</a>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for the presence of PLINK and non-standard RDP usage with event logs, firewall logs, and registry keys as described in the FireEye blog post "<a href="https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html">Bypassing Network Restrictions Through RDP Tunneling.</a>"<br/>
&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Find internal RDP pivoting by looking for bitmap cache files under user accounts that should not be accessing sensitive systems via RDP. Look for bitmap cache files such as bcache22.bmc under default, service, or administrator accounts or any account not expected to be conducting internal RDP accesses to sensitive systems in a protected OT-connected zone, especially in the DMZ or DCS areas like HMIs or engineering workstations.<br/>
&nbsp; <br/>
C2 using hard-coded SSH private keys&#09;&#09;&#09;&#09;&#09;&#09;Look for PEs with hard-coded OpenSSH private keys.<br/>
&nbsp; <br/>
Use of direct RDP<br/>
<a href="https://attack.mitre.org/techniques/T1076/">ATT&amp;CK: T1076</a>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for inbound RDP connections with default host information, non-standard or unexpected locale IDs, or other metadata. See also the <a href="https://www.fireeye.com/blog/threat-research/2018/04/establishing-a-baseline-for-remote-desktop-protocol.html">FireEye blog post on baselining RDP</a>&nbsp;activity.<br/>
&nbsp; <br/>
C2 using source systems with default Windows hostnames&#09;&#09;&#09;Look for default Windows hostnames that fit the structure WIN-[A-Z0-9]{11} (e.g., WIN-ABCDEFGH1JK) in PE certificates, SSL and SSH certificates, and RDP handshakes.<br/>
&nbsp; <br/>
C2 using SSH&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for new, unique, or unusual SSH sessions. Logging of SSH keys and fingerprints would quickly and easily identify an anomalous session as a result of malware. Look for SSH over non-standard ports.<br/>
&nbsp; <br/>
Compromised VPN accounts<br/>
<a href="https://attack.mitre.org/techniques/T1078/">ATT&amp;CK: T1078</a>&nbsp; &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for VPN logon anomalies based on infeasible patterns such as source account location, IP address, and hostname associations. Check out the FireEye blog post and free toolset for VPN logon analysis, <a href="https://www.fireeye.com/blog/threat-research/2018/05/remote-authentication-geofeasibility-tool-geologonalyzer.html">GeoLogonalyzer</a>.<ul><li style="list-style-type: none">&nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;If you use SMS-based MFA, look for phone numbers registered outside the country where your employees operate.</li>
</ul>
<br/>
Malware masquerading as Microsoft Corporation&#09;&#09;&#09;&#09;&#09;Look for PEs with mismatched PE metadata such as contains "Bitvise" strings and also "Microsoft Corporation" in the metadata. Look for unsigned "Microsoft Corporation" binaries in the group's common staging directories.<br/>
&nbsp; <br/>
Use of customized Bitvise binaries&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for PEs with Bitvise PDB path strings such as d:\repos\main\ssh2\.<br/>
&nbsp; <br/>
Use of customized OpenSSH binaries&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for PEs with content "Microsoft openSSH client."<br/>
&nbsp; <br/>
Use of customized Cryptcat but with default passwor&#09;&#09;&#09;&#09;Look for PEs that drop Cryptcat binaries or contain Cryptcat string content such as the default password "metallica."<br/>
&nbsp; <br/>
Timestomping via PowerShell<br/>
<a href="https://attack.mitre.org/techniques/T1099/">ATT&amp;CK: T1099</a>&nbsp; &nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for timestomping command strings such as ".CreationTime=" in PowerShell scripts or in PowerShell command-line entries. Look for PEs with NTFS creation time prior to PE compile time.<br/>
&nbsp; <br/>
Deployment of binaries with debug information from developer <br/>
workstations with Visual Studio 2010&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for PEs with PDB paths containing default or generic paths such as<br/>
&nbsp;<ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li>\Users\user\Documents\Visual Studio 2010\</li>
<li>\Documents\Visual Studio 2010\.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp;<br/>
Use of Thinstall for packaging malware &nbsp;&#09;&#09;&#09;&#09;&#09;&#09;Look for PE with content "thinstall\modules\boot_loader.pdb." <br/>
&nbsp;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Look for Thinstall binaries that have created virtualized files in the context of the SYSTEM user "C:\Windows\SysWOW64\config\systemprofile\AppData\Roaming\Thinstall\."<br/>
&nbsp; <br/>
Use of favored directories for operating, staging and executing files&#09;Look for new, unexpected, or otherwise anomalous binaries in the following directories:<br/>
&nbsp;<ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li>C:\Windows\system32\inetsrv\</li>
<li>C:\Windows\temp\</li>
<li>C:\Windows\SysWOW64\wbem</li>
<li>C:\Windows\SysWOW64\drivers</li>
<li>C:\Windows\SysWOW64</li>
<li>C:\Windows\system32\wbem\</li>
<li>C:\Windows\system32\drivers\</li>
<li>C:\Windows\system32\</li>
<li>C:\Windows\</li>
<li>C:\Users\Public\Libraries\</li>
<li>C:\Users\administrator\appdata\local\temp\</li>
<li>C:\ssh\</li>
<li>C:\perflogs\admin\servermanager\ssh\</li>
<li>C:\perflogs\admin\servermanager\</li>
<li>C:\perflogs\admin\</li>
<li>C:\perflogs\</li>
<li>C:\cpqsystem\</li>
<li>C:\hp\hpdiags\</li>
<li>C:\hp\bin\log\</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp; </body></html>