<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Build Malicious Code From Fonts</title>
</head><body>https://sysadminconcombre.blogspot.com/2018/11/golem-malware-malware-hiding-in-your.html<br/>
<br/>
Great writeup. <br/>
<br/>
Objective<br/>
I would like a solution that meets the following criteria:<ul><li style="list-style-type: none">Does not contain any malicious code (not even malicious bytes http://www.exploit-monday.com/2011/09/dropping-executables-with-powershell.html) to go through the perimeter (mail filtering, sandboxing, etc)</li>
<li style="list-style-type: none">Does not download any malicious code</li>
<li style="list-style-type: none">Execute malicious code </li>
</ul>
<br/>
Identifying a binary candidate:<br/>
Wingdings font. The same font between a lot of Windows versions. <br/>
<br/>
Process to build malicious executable:<br/>
<ul><li style="list-style-type: none">Collect the bytes from our malware on our computer</li>
<li style="list-style-type: none">Compare the first byte of our malware to the Wingdings font</li>
<li style="list-style-type: none">As soon as we find the same byte in the font, we record its position in a text file</li>
<li style="list-style-type: none">We repeat this process until we have found all the bytes contained in the malware and recorded their position in our text file</li>
<li style="list-style-type: none">Our payload will contain the position from the Wingdings font for each of its byte</li>
<li style="list-style-type: none">Once on the victim machine, the payload will build its malicious components by using the bytes position from the Wingdings font</li>
</ul>
<br/>
<br/>
Provided is powershell code to find the bytes from the font and the powershell to generate the VBA code to insert into a macro. <br/>
<br/>
The final VBA should be heavily edited. <br/>
<br/>
</body></html>