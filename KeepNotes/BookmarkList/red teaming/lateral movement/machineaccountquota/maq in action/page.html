<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>MAQ in Action</title>
</head><body><b>MachineAccountQuota In Action </b><br/>
Let’s take the above rules and apply them to a compromised AD account that has <a href="https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/">SeEnableDelegationPrivilege</a>. As mentioned in rule 4, even though an account has write access to an attribute, the write attempt is still subject to validation.<br/>
<img src="image.png" /><br/>
<br/>
However, if you happen to compromise an account with the correct privilege, such as <a href="https://www.youtube.com/watch?v=ze1UcSLOypw">SeEnableDelegationPrivilege</a>, things can get interesting. &nbsp;<br/>
<img src="image 2.png" /><br/>
<br/>
<br/>
<br/>
In this case, we can use the ‘INVEIGH\kevin’ account, along with MAQ, to create and configure a machine account object capable of performing Kerberos unconstrained delegation. Conveniently, this can remove the requirement for finding an existing suitable AD object for leveraging SeEnableDelegationPrivilege. Basically, we can just make our own through MAQ.<br/>
&nbsp;<br/>
Note, this is one of those scenarios where, if you can, just joining a domain with your own Windows system can make things easier. If you do go that route, just enable unconstrained delegation on the machine account object and leverage it just like you would on a compromised system. The good news is that the process is still very manageable when we use only a machine account.<br/>
&nbsp; <br/>
</body></html>