<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CBC Mode</title>
</head><body>https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_(ECB)<br/>
<br/>
General notes<br/>
Improves on ECB by preventing duplicate blocks (adding 'randomness' to each block). <br/>
'First Block Problem'<br/>
&nbsp;&#09;Use a special IV the length of the block size as the XOR input with the first block <br/>
IV 'should' never repeat. If it does, analyzing the first block may reveal information about the plain text<br/>
<br/>
Cipher Block Chaining (CBC)<br/>
Ehrsam, Meyer, Smith and Tuchman invented the Cipher Block Chaining (CBC) mode of operation in 1976.<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#cite_note-11">[11]</a>&nbsp;In CBC mode, each block of plaintext is <a href="https://en.wikipedia.org/wiki/XOR">XORed</a>&nbsp;with the previous ciphertext block before being encrypted. This way, each ciphertext block depends on all plaintext blocks processed up to that point. To make each message unique, an <a href="https://en.wikipedia.org/wiki/Initialization_vector">initialization vector</a>&nbsp;must be used in the first block. <br/>
<br/>
<img src="image.png" /><br/>
<br/>
<img src="image 2.png" /><br/>
<br/>
<br/>
If the first block has index 1, the mathematical formula for CBC encryption is <br/>
<img src="image 3.png" /><br/>
<br/>
<br/>
while the mathematical formula for CBC decryption is <br/>
<img src="image 4.png" /><br/>
<br/>
Example:<br/>
<img src="image 5.png" /><br/>
<br/>
<br/>
CBC has been the most commonly used mode of operation. Its main drawbacks are that encryption is sequential (i.e., it cannot be parallelized), and that the message must be padded to a multiple of the cipher block size. One way to handle this last issue is through the method known as <a href="https://en.wikipedia.org/wiki/Ciphertext_stealing">ciphertext stealing</a>. Note that a one-bit change in a plaintext or initialization vector (IV) affects all following ciphertext blocks. <br/>
<br/>
Decrypting with the incorrect IV causes the first block of plaintext to be corrupt but subsequent plaintext blocks will be correct. This is because each block is XORed with the ciphertext of the previous block, not the plaintext, so one does not need to decrypt the previous block before using it as the IV for the decryption of the current one. This means that a plaintext block can be recovered from two adjacent blocks of ciphertext. As a consequence, decryption <i>can</i>&nbsp;be parallelized. Note that a one-bit change to the ciphertext causes complete corruption of the corresponding block of plaintext, and inverts the corresponding bit in the following block of plaintext, but the rest of the blocks remain intact. This peculiarity is exploited in different <a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a>, such as <a href="https://en.wikipedia.org/wiki/POODLE">POODLE</a>. <br/>
<br/>
<i>Explicit Initialization Vectors</i><a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#cite_note-12">[12]</a>&nbsp;takes advantage of this property by prepending a single random block to the plaintext. Encryption is done as normal, except the IV does not need to be communicated to the decryption routine. Whatever IV decryption uses, only the random block is "corrupted". It can be safely discarded and the rest of the decryption is the original plaintext. <br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>