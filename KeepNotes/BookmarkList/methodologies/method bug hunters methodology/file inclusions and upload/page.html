<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>File Inclusions and Upload</title>
</head><body>Tactical Fuzzing - FI &amp; Uploads Local file inclusion <br/>
Core Idea: Does it (or can it) interact with the server file system?<br/>
&nbsp;<br/>
[Liffy] (<a href="https://github.com/rotlogix/liffy">https://github.com/rotlogix/liffy</a>) is new and cool here but you can also use <br/>
[Seclists] (<a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/JHADDIX_LFI.txt">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/JHADDIX_LFI.txt</a>):<br/>
&nbsp;<br/>
Malicious File Upload <br/>
This is an important and common attack vector in this type of testing. A file upload functions need a lot of protections to be adequately secure.<br/>
&nbsp;<br/>
Attacks:<br/>
&nbsp;<ul><li>Upload unexpected file format to achieve code exec (swf, html, php, php3, aspx, ++) Web shells or...</li>
<li>Execute XSS via same types of files. Images as well!</li>
<li>Attack the parser to DoS the site or XSS via storing payloads in metadata or file header</li>
<li>Bypass security zones and store malware on target site via file polyglots</li>
</ul>
<br/>
File upload attacks are a whole presentation. Try this one to get a feel for bypass techniques:<br/>
&nbsp;<ul><li>content type spoofing</li>
<li>extension trickery</li>
<li>[File in the hole! presentaion] (<a href="https://www.nds.rub.de/media/attachments/files/2012/11/File-in-the-hole.pdf">https://www.nds.rub.de/media/attachments/files/2012/11/File-in-the-hole.pdf</a>)</li>
</ul>
<br/>
As referenced file polyglots can be used to store malware on servers! [See @dan_crowley ‘s talk] (<a href="http://goo.gl/pquXC2">http://goo.gl/pquXC2</a>) [and @angealbertini research:] (corkami.com)<br/>
&nbsp;Remote file includes and redirects <br/>
Look for any param with another web address in it. Same params from LFI can present here too.<br/>
&nbsp;<br/>
Common blacklist bypasses:<br/>
&nbsp;<ul><li>&nbsp;escape "/" with "/" or “//” with “//”</li>
<li>try single "/" instead of "//"</li>
<li>remove http i.e. "continue=//google.com"</li>
<li>“//\” , “|/” , “/%09/”</li>
<li>encode, slashes</li>
<li>”./” CHANGE TO “..//”</li>
<li>”../” CHANGE TO “....//”</li>
<li>”/” CHANGE TO “//”</li>
</ul>
<br/>
Redirections Common Parameters or Injection points:<br/>
&nbsp;<ul><li>dest=</li>
<li>continue=</li>
<li>redirect=</li>
<li>url= (or anything with “url” in it)</li>
<li>uri= (same as above)</li>
<li>window=</li>
<li>next=</li>
</ul>
<br/>
RFI Common Parameters or Injection points:<br/>
&nbsp;<ul><li>File=</li>
<li>document=</li>
<li>Folder=</li>
<li>root=</li>
<li>Path=</li>
<li>pg=</li>
<li>style=</li>
<li>pdf=</li>
<li>template=</li>
<li>php_path=</li>
<li>doc=</li>
</ul>
</body></html>