<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SQL Injection</title>
</head><body><b>Summary</b><br/>
<br/>
An SQL injection attack consists of insertion or "injection" of either a partial or complete SQL query via the data input or transmitted from the client (browser) to the web application. A successful SQL injection attack can read sensitive data from the database, modify database data (insert/update/delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file existing on the DBMS file system or write files into the file system, and, in some cases, issue commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL commands are injected into data-plane input in order to affect the execution of predefined SQL commands.<br/>
<br/>
In general the way web applications construct SQL statements involving SQL syntax written by the programmers is mixed with user-supplied data. Example:<br/>
select title, text from news where id=$id<br/>
<br/>
In the example above the variable $id contains user-supplied data, while the remainder is the SQL static part supplied by the programmer; making the SQL statement dynamic.<br/>
<br/>
Because the way it was constructed, the user can supply crafted input trying to make the original SQL statement execute further actions of the user's choice. The example below illustrates the user-supplied data “10 or 1=1”, changing the logic of the SQL statement, modifying the WHERE clause adding a condition “or 1=1”.<br/>
<br/>
select title, text from news where id=10 or 1=1<br/>
<br/>
<br/>
SQL Injection attacks can be divided into the following three classes: <br/>
&nbsp;<ul><li>&nbsp;Inband: data is extracted using the same channel that is used to inject the SQL code. This is the most straightforward kind of attack, in which the retrieved data is presented directly in the application web page.</li>
<li>&nbsp;Out-of-band: data is retrieved using a different channel (e.g., an email with the results of the query is generated and sent to the tester).</li>
<li>&nbsp;Inferential or Blind: there is no actual transfer of data, but the tester is able to reconstruct the information by sending particular requests and observing the resulting behavior of the DB Server.</li>
</ul>
<br/>
<br/>
A successful SQL Injection attack requires the attacker to craft a syntactically correct SQL Query. If the application returns an error message generated by an incorrect query, then it may be easier for an attacker to reconstruct the logic of the original query and, therefore, understand how to perform the injection correctly. However, if the application hides the error details, then the tester must be able to reverse engineer the logic of the original query. <br/>
<br/>
About the techniques to exploit SQL injection flaws there are five commons techniques. Also those techniques sometimes can be used in a combined way (e.g. union operator and out-of-band): <br/>
&nbsp;<ul><li>&nbsp;Union Operator: can be used when the SQL injection flaw happens in a SELECT statement, making it possible to combine two queries into a single result or result set.</li>
<li>&nbsp;Boolean: use Boolean condition(s) to verify whether certain conditions are true or false.</li>
<li>&nbsp;Error based: this technique forces the database to generate an error, giving the attacker or tester information upon which to refine their injection.</li>
<li>&nbsp;Out-of-band: technique used to retrieve data using a different channel (e.g., make a HTTP connection to send the results to a web server).</li>
<li>&nbsp;Time delay: use database commands (e.g. sleep) to delay answers in conditional queries. It is useful when attacker doesn’t have some kind of answer (result, output, or error) from the application.</li>
</ul>
&nbsp;<br/>
<br/>
<br/>
<b>Tools</b>&nbsp;<ul><li>&nbsp;SQL Injection Fuzz Strings (from wfuzz tool) - <a href="https://wfuzz.googlecode.com/svn/trunk/wordlist/Injections/SQL.txt">https://wfuzz.googlecode.com/svn/trunk/wordlist/Injections/SQL.txt</a></li>
<li>&nbsp;<a href="https://www.owasp.org/index.php/Category:OWASP_SQLiX_Project">OWASP SQLiX</a></li>
<li>&nbsp;Francois Larouche: Multiple DBMS SQL Injection tool - <a href="http://www.sqlpowerinjector.com/index.htm">SQL Power Injector</a></li>
<li>&nbsp;ilo--, Reversing.org - <a href="http://packetstormsecurity.org/files/43795/sqlbftools-1.2.tar.gz.html">sqlbftools</a></li>
<li>&nbsp;Bernardo Damele A. G.: sqlmap, automatic SQL injection tool - <a href="http://sqlmap.org/">http://sqlmap.org/</a></li>
<li>&nbsp;icesurfer: SQL Server Takeover Tool - <a href="http://sqlninja.sourceforge.net">sqlninja</a></li>
<li>&nbsp;Pangolin: Automated SQL Injection Tool - <a href="http://www.nosec.org/en/productservice/pangolin/">Pangolin</a></li>
<li>&nbsp;Muhaimin Dzulfakar: MySqloit, MySql Injection takeover tool - <a href="http://code.google.com/p/mysqloit/">http://code.google.com/p/mysqloit/</a></li>
<li>&nbsp;Antonio Parata: Dump Files by SQL inference on Mysql - <a href="http://sqldumper.ruizata.com/">SqlDumper</a></li>
<li>&nbsp;<a href="https://code.google.com/p/bsqlbf-v2/">bsqlbf, a blind SQL injection tool</a>&nbsp;in Perl</li>
</ul>
References <ul><li>&nbsp;<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">Top 10 2013-A1-Injection</a></li>
<li>&nbsp;<a href="https://www.owasp.org/index.php/SQL_Injection">SQL Injection</a></li>
</ul>
<br/>
Technology specific Testing Guide pages have been created for the following DBMSs: <br/>
&nbsp;<ul><li>&nbsp;<a href="https://www.owasp.org/index.php/Testing_for_Oracle">&nbsp;Oracle</a></li>
<li>&nbsp;<a href="https://www.owasp.org/index.php/Testing_for_MySQL">&nbsp;MySQL</a></li>
<li>&nbsp;<a href="https://www.owasp.org/index.php/Testing_for_SQL_Server">&nbsp;SQL Server</a></li>
</ul>
<br/>
<b>Whitepapers</b><br/>
<ul><li>&nbsp;Victor Chapela: "Advanced SQL Injection" - <a href="http://www.owasp.org/images/7/74/Advanced_SQL_Injection.ppt">http://www.owasp.org/images/7/74/Advanced_SQL_Injection.ppt</a></li>
<li>&nbsp;Chris Anley: "Advanced SQL Injection In SQL Server Applications" - <a href="https://sparrow.ece.cmu.edu/group/731-s11/readings/anley-sql-inj.pdf">https://sparrow.ece.cmu.edu/group/731-s11/readings/anley-sql-inj.pdf</a></li>
<li>&nbsp;Chris Anley: "More Advanced SQL Injection" - <a href="http://www.encription.co.uk/downloads/more_advanced_sql_injection.pdf">http://www.encription.co.uk/downloads/more_advanced_sql_injection.pdf</a></li>
<li>&nbsp;David Litchfield: "Data-mining with SQL Injection and Inference" - <a href="http://www.databasesecurity.com/webapps/sqlinference.pdf">http://www.databasesecurity.com/webapps/sqlinference.pdf</a></li>
<li>&nbsp;Imperva: "Blinded SQL Injection" - <a href="https://www.imperva.com/lg/lgw.asp?pid=369">https://www.imperva.com/lg/lgw.asp?pid=369</a></li>
<li>&nbsp;Ferruh Mavituna: "SQL Injection Cheat Sheet" - <a href="http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/">http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/</a></li>
<li>&nbsp;Kevin Spett from SPI Dynamics: "SQL Injection" - <a href="https://docs.google.com/file/d/0B5CQOTY4YRQCSWRHNkNaaFMyQTA/edit">https://docs.google.com/file/d/0B5CQOTY4YRQCSWRHNkNaaFMyQTA/edit</a></li>
<li>&nbsp;Kevin Spett from SPI Dynamics: "Blind SQL Injection" - <a href="http://www.net-security.org/dl/articles/Blind_SQLInjection.pdf">http://www.net-security.org/dl/articles/Blind_SQLInjection.pdf</a></li>
<li>&nbsp;"ZeQ3uL" (Prathan Phongthiproek) and "Suphot Boonchamnan": "Beyond SQLi: Obfuscate and Bypass" - <a href="https://www.exploit-db.com/papers/17934/">https://www.exploit-db.com/papers/17934/</a></li>
<li>&nbsp;Adi Kaploun and Eliran Goshen, Check Point Threat Intelligence &amp; Research Team: "The Latest SQL Injection Trends" - <a href="http://blog.checkpoint.com/2015/05/07/latest-sql-injection-trends/">http://blog.checkpoint.com/2015/05/07/latest-sql-injection-trends/</a></li>
</ul>
<br/>
<b>Documentation on SQL injection vulnerabilities in products</b>&nbsp;<br/>
&nbsp;<ul><li>&nbsp;<a href="https://www.vanstechelman.eu/content/anatomy-of-the-sql-injection-in-drupals-database-comment-filtering-system-sa-core-2015-003">Anatomy of the SQL injection in Drupal's database comment filtering system SA-CORE-2015-003</a></li>
</ul>
&nbsp;<br/>
</body></html>