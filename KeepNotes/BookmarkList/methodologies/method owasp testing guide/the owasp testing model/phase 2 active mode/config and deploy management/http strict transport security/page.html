<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>HTTP Strict Transport Security</title>
</head><body><b>Summary </b><br/>
The HTTP Strict Transport Security (HSTS) header is a mechanism that web sites have to communicate to the web browsers that all traffic exchanged with a given domain must always be sent over https, this will help protect the information from being passed over unencrypted requests.<br/>
<br/>
Considering the importance of this security measure it is important to verify that the web site is using this HTTP header, in order to ensure that all the data travels encrypted from the web browser to the server.<br/>
<br/>
The HTTP Strict Transport Security (HSTS) feature lets a web application to inform the browser, through the use of a special response header, that it should never establish a connection to the the specified domain servers using HTTP. Instead it should automatically establish all connection requests to access the site through HTTPS. <br/>
<br/>
The HTTP strict transport security header uses two directives: <br/>
&nbsp;<ul><li>max-age: to indicate the number of seconds that the browser should automatically convert all HTTP requests to HTTPS.</li>
<li>includeSubDomains: to indicate that all web applicationâ€™s sub-domains must use HTTPS.</li>
</ul>
<br/>
Here's an example of the HSTS header implementation:<br/>
&nbsp;Strict-Transport-Security: max-age=60000; includeSubDomains &nbsp;<br/>
<br/>
The use of this header by web applications must be checked to find if the following security issues could be produced: <br/>
&nbsp;<ul><li>&nbsp;Attackers sniffing the network traffic and accessing the information transferred through an unencrypted channel.</li>
<li>&nbsp;Attackers exploiting a man in the middle attack because of the problem of accepting certificates that are not trusted.</li>
<li>&nbsp;Users who mistakenly entered an address in the browser putting HTTP instead of HTTPS, or users who click on a link in a web application which mistakenly indicated the http protocol.</li>
</ul>
<br/>
<b>How to Test </b><br/>
Testing for the presence of HSTS header can be done by checking for the existence of the HSTS header in the server's response in an interception proxy, or by using curl as follows: <br/>
&nbsp; $ curl -s -D- https://domain.com/ | grep Strict &nbsp;<br/>
<br/>
Result expected:<br/>
&nbsp; Strict-Transport-Security: max-age=... &nbsp;<br/>
<br/>
<b>References </b><ul><li>&nbsp;OWASP HTTP Strict Transport Security - <a href="https://www.owasp.org/index.php/HTTP_Strict_Transport_Security">https://www.owasp.org/index.php/HTTP_Strict_Transport_Security</a></li>
<li>&nbsp;OWASP Appsec Tutorial Series - Episode 4: Strict Transport Security - <a href="http://www.youtube.com/watch?v=zEV3HOuM_Vw">http://www.youtube.com/watch?v=zEV3HOuM_Vw</a></li>
<li>&nbsp;HSTS Specification: <a href="http://tools.ietf.org/html/rfc6797">http://tools.ietf.org/html/rfc6797</a></li>
</ul>
&nbsp;</body></html>