<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Attacking HSRP</title>
</head><body>If the secondary device fails to see &nbsp;a preconfigured number of 'hello' messages, it believes the primary has failed and takes on the primary role. <br/>
HSRP uses an 8-bit priority field with highest priority being 255. <br/>
<br/>
<b>Default Password</b><br/>
By default, HSRP uses the default password "cisco"<br/>
md5-based auth using a shared secret is supported<br/>
<br/>
<b>Plaintext Authentication</b><br/>
Multicast 'hello' messages include plaintext credentials<br/>
HSRP traffic is sent via multicast 224.0.0.2. If HSRP traffic isn't segregated (VLAN/management or otherwise), all nodes will be able to see this traffic even without MitM. <br/>
<br/>
<b>Becoming MitM (aka Becoming the Primary Router)</b><br/>
With the auth, attacker can send HSRP hello messages with highest priority<br/>
1. Send "hello" messages to 224.0.0.2 with higher priority<br/>
2. Former routers yield priority<br/>
3. Change MAC to 00:00:0c:07:ac:XX and change IP to default gateway IP<br/>
4. Attacker becomes MitM<br/>
<br/>
Note: Periodically send 'hello' messages to maintain. Otherwise other HSRP routers will assume you died and retake their position. <br/>
See [yersinia] in Tools section for HSRP automated attack</body></html>