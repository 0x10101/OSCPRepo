<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Giddy - ASP MSSQL Out of Band PTH WinRM</title>
</head><body><br/>
/remote is Windows Powershell Web Access, requires username and password<br/>
/mvc is an ASP.net application. Can register and login and search. <br/>
<br/>
The Search box enables SQL errors. Other parameters like ID and Item. <br/>
Can issue xp_dirtree function to send NTLM hash to attacker. Crack/pass for more access. <br/>
<br/>
https://www.gracefulsecurity.com/sql-injection-cheat-sheet-mssql<br/>
Out-of-band data retrieval<br/>
<br/>
Get the NTLM for GIDDY\Stacy<br/>
Crack it and log into WinRM or /remote web powershell <br/>
<br/>
Notice unifivideo file<br/>
Tries to load C:\ProgramData\unifi-video\taskkill.exe as system, but it does not exist by default. <br/>
Create your own favorite binary, restart unifi-video and GG<br/>
<br/>
Need to bypass restrictions any number of ways. Ippsec used a DotNet revshell that Windows Defender did not remove. <br/>
<br/>
Locate the service directly in registry:<br/>
Set-Location 'HKLM\SYSTEM\CurrentControlSet\Services'<br/>
<br/>
Find the item you want:<br/>
Get-ChildItem .<br/>
<br/>
Get-ChildItem . | where-object { $_.Name -like '*UnifiVideoService*' } <br/>
<br/>
Restart service:<br/>
Stop-Service "Ubiquiti UniFi Video"<br/>
Start-Service "Ubiquiti UniFi Video"<br/>
<br/>
and GG</body></html>